{% extends 'frontend/layouts/base.html' %}

{% block content %}
<section class="breadcrumb-section border-top py-3 bg-light">
    <div class="container">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb mb-0">
                <li class="breadcrumb-item">
                    <a href="{% url 'home' %}" class="text-decoration-none text-dark">
                        <i class="fas fa-home"></i> Home
                    </a>
                </li>
                <li class="breadcrumb-item active text-dark" aria-current="page">
                    Checkout
                </li>
            </ol>
        </nav>
    </div>
</section>

<section class="checkout-section py-5">
    <div class="container">
        <div class="row g-5">
            <!-- Checkout Form -->
            <div class="col-lg-7">
                <div class="card border-0 shadow-sm">
                    <div class="card-header bg-transparent border-0">
                        <h4 class="fw-bold mb-0 text-dark">Billing Details</h4>
                    </div>
                    <div class="card-body">
                        <form method="POST" action="{% url 'checkout' %}">
                            {% csrf_token %}
                            {{ order_form.non_field_errors }}

                            <div class="row g-3">
                                {% for field in order_form %}
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            {{ field }}
                                            {% if field.errors %}
                                                <div class="text-danger small">{{ field.errors|join:", " }}</div>
                                            {% endif %}
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>

                            <div class="mt-4 text-end">
                                <button type="submit" class="btn btn-dark btn-lg px-4 fw-semibold">
                                    <i class="fas fa-lock me-2"></i> Place Order
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Order Summary -->
            <div class="col-lg-5">
                <div class="card border-0 shadow-sm">
                    <div class="card-header bg-transparent border-0">
                        <h4 class="fw-bold mb-0 text-dark">Order Summary</h4>
                    </div>
                    <div class="card-body">
                        {% if bag_items %}
                            <ul class="list-group list-group-flush">
                                {% for item in bag_items %}
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <div>
                                            <strong class="text-dark">{{ item.product.product_name }}</strong><br>
                                            <small class="text-muted">Qty: {{ item.quantity }}</small>
                                        </div>
                                        <span class="text-dark">{{ item.product.price|floatformat:2 }}</span>
                                    </li>
                                {% endfor %}
                            </ul>
                            <hr>
                            <div class="d-flex justify-content-between mb-2">
                                <span class="text-muted">Order Total</span>
                                <span class="text-dark fw-semibold">{{ total|floatformat:2 }}</span>
                            </div>
                            <div class="d-flex justify-content-between mb-2">
                                <span class="text-muted">Delivery</span>
                                <span class="text-dark fw-semibold">{{ delivery|floatformat:2 }}</span>
                            </div>
                            <div class="d-flex justify-content-between fw-bold fs-5 text-dark">
                                <span>Grand Total</span>
                                <span>{{ grand_total|floatformat:2 }}</span>
                            </div>
                        {% else %}
                            <p class="text-muted">Your cart is empty.</p>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<style>
    .stripe-style-input {
        background-color: #fff;
        border: 1px solid #ccc;
        color: #000;
        width: 100%;
        padding: 10px 12px;
        border-radius: 5px;
        outline: none;
        transition: all 0.2s ease;
    }

    .stripe-style-input:focus {
        border-color: #000;
        box-shadow: 0 0 0 0.2rem rgba(0, 0, 0, 0.15);
    }

    .btn-dark {
        background-color: #000;
        border-color: #000;
    }

    .btn-dark:hover {
        background-color: #333;
        border-color: #333;
    }
</style>
{% endblock %}
